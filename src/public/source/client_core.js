window.bot={target:null,playerAttacking:!1,previousDistance:null,previousPosition:null,blacklistObjectBuffer:null,blacklistObjects:[]},window.shootObj=[],window.packets={collectGlow:"141a91347d20e68a83d4be4bdf4169e6ae8ccbf0",playerMoveCoord:"53fd7c7a59d3d6b25e6d5f2c25396da01d69b10a",finishMove:"41daafd5889f5df9075cf24dd642bcc2c25eb15a",movePlayer:"e54690eec19a48117110763414bbdaa492ced619",routeMessage:"de757600ec37073214228e2c030e08bf8aafe550",shootGameObject:"5d3919e9a78963d3695fc0fefff39435cff00572",removeGameObject:"f224819036f1552c926fd9609e30b00253772646",mapJson:"b06ddf47072b6bbd6bc73309965a5cbbebc85f2a"};const tiles=ArmadaBattle.Game.game.map.layers[0].data;var interval;function getTileFromWorld(e,t){return ArmadaBattle.Game.game.map.layers[0].data[e/40|0][t/40|0]}function moveShip(e,t){let a=getTileFromWorld(e,t);ArmadaBattle.Game.myPlayer.move(null,{x:e,y:t},{goTile:a,speed:ArmadaBattle.Game.myPlayer.options.speed,generatePath:!0,waitBackend:!0})}function randomInt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function getCurrentPosition(){return ArmadaBattle.Game.myPlayer.GUI.group.position}function getNearestObject(e){let t=Number.MAX_VALUE;var a=null;for(let o of e){let e=ArmadaBattle.Game.myPlayer.GUI.group.position,n=Math.pow(o.position.x-e.x,2)+Math.pow(o.position.y-e.y,2);n<t&&(t=n,a=o)}return a}function glows(){return ArmadaBattle.Game.glows}function animals(){return ArmadaBattle.Game.animals}function npcs(){return ArmadaBattle.Game.npcs}function getMyPlayer(){return ArmadaBattle.Game.myPlayer}function getPos(e){return e.GUI.group.position}function isInRange(e,t){let a=getPos(getMyPlayer()),o=getPos(e);return ArmadaBattle.CustomHelper.getDistanceBetweenTwoPoints(a,o)<=t}function getObjects(){var e=[],t=[],a=[],o=[];return t=npcs(),a=animals(),o=glows(),window.bs.cb&&glows().length>0&&(o=o.filter(function(e){return console.log(`Filtered: ${e.id}`),!bot.blacklistObjects.includes(e.id)}),e=e.concat(o)),window.bs.sn&&t.length>0&&(console.log("_true"),shootObj.length>0?(t=npcs().filter(e=>shootObj.includes(e.options.nickname)),bs.onlyFullHp&&(console.log("Only full hp active."),t=t.filter(function(e){return e.options.HP==e.options.maxHP})),e=e.concat(t)):e=e.concat(t)),window.bs.sa&&a.length>0&&(shootObj.length>0?(a=animals().filter(e=>shootObj.includes(e.options.nickname)),e=e.concat(a)):e=e.concat(a)),e}function isTargetValid(e){var t=[];for("animal"==e.type?(t=animals(),console.log("animal")):"npc"==e.type?(t=npcs(),console.log("npc")):(t=glows(),console.log("type: glow")),i=0;i<t.length;i++)if(t[i].id===(e&&e.id))return!0;return!1}function updateTarget(){var e=getObjects();if(e.length>0){let t=getNearestObject(e);return bot.target=t,!0}return!1}function isPlayerMoving(){return Boolean(getMyPlayer().GUI.gameObject.currentMove)&&getMyPlayer().GUI.gameObject.currentMove.tween&&getMyPlayer().GUI.gameObject.currentMove.tween.isRunning}function randomMove(){if(!(isPlayerMoving()>0)){var e=randomInt(1e3,7e3),t=randomInt(1e3,7e3);return console.log("moving random: "+e+" "+t),moveShip(e,t),!0}}function proxy_to_client(e){let t=e.data;if("info"==t[0]){console.log(t);var a=t[1].text;parseMessage(a),console.log(a)}return"b06ddf47072b6bbd6bc73309965a5cbbebc85f2a"==t[0]&&console.log(t[0]),e.data=t,e}function parseMessage(e){if(e.includes("#{you_collected}")){var t=e.match(/.*?#{as_reward}(.*?)#.*?} #{(.*?)}/);let a=t[1].trim(),o=t[2];"#moneyTypes_5e39be59752dc454eb6a7d56_name"===o&&(o="diamond"),console.log("collected: "+a+" "+o+"s")}else if(e.includes("you_earnt")){e=e.split("as_reward}")[1];for(var a=/(.*?) #\{pieces\} #\{(.*?)\}/g,o=[];match=a.exec(e);)o.push(match);for(var n=0;n<o.length;n++){let e=o[n],t=0|e[1].split(" ")[1].trim(),a=e[2];"#moneyTypes_5e39be2b752dc454eb6a7d55_name"===a&&(a="gold"),console.log("collected: "+t+" "+a+"s")}}}function proxy_to_server(e,t){return t}function setup_proxy(){const e=socket.emit;socket.emit=function(t,a){a=proxy_to_server(t,a),e.call(socket,t,a)};const t=socket.onevent;socket.onevent=function(e){e.data;e=proxy_to_client(e),t.call(socket,e)}}const _startShoot=ArmadaBattle.Game.myPlayer.startShoot;ArmadaBattle.Game.myPlayer.startShoot=function(e,t,a,o){window.bot.playerAttacking=!0,_startShoot.call(ArmadaBattle.Game.myPlayer,e,t,a,o)};const _cancelShoot=ArmadaBattle.Game.myPlayer.cancelShoot;function getMapObjectByName(e){let t=ArmadaBattle.Game.mapObjects.filter(t=>t.options.nickname.includes(e));return t.length>0?t[0]:null}function pointInTowerRange(e,t){let a=getMapObjectByName("Savaş Adası");return ArmadaBattle.CustomHelper.getDistanceBetweenTwoPoints(a.GUI.group.position,{x:e,y:t})<=1200}function blacklist(){bot.target&&bot.target.id==bot.blacklistObjectBuffer&&(bot.blacklistObjects.includes(bot.blacklistObjectBuffer)||(bot.target=null,bot.blacklistObjects.push(bot.blacklistObjectBuffer),console.log(`Blacklisted ${bot.blacklistObjectBuffer}`)))}function cycle(){"use strict";$("#reborn").is(":visible")&&$("[ng-click='reborn()']").trigger("click"),$("#duplicateTabs").is(":visible")&&$('[ng-click="connectDuplicatePlayer()"]').trigger("click");let e=10,t=40*randomInt(-e,e),a=40*randomInt(-e,e);var o=getPos(getMyPlayer());var n=getMapObjectByName("Savaş Adası").GUI.group.position;let r=ArmadaBattle.CustomHelper.getDistanceBetweenTwoPoints(n,o);var l=getCurrentPosition(),i=Math.atan2(l.y-n.y,l.x-n.x);if(bs.ai&&r<1300){var c={x:l.x+600*Math.cos(i),y:l.y+600*Math.sin(i)};return c.x=40*Math.round((c.x+Number.EPSILON)/40),c.y=40*Math.round((c.y+Number.EPSILON)/40),c.x+=t,c.y+=a,moveShip(c.x,c.y),void console.log(`Flying to ${c.x}, ${c.y}`)}if(ArmadaBattle.Game.myPlayer.options.HP<ArmadaBattle.Game.myPlayer.options.maxHP*bs.repLimit/100&&!bot.playerAttacking)"active"==document.querySelector("#repairButton").classList[0]&&ArmadaBattle.Control.repairEvent();else{if(ArmadaBattle.Game.myPlayer.cancelRepair(),t=40*randomInt(-(e=3),e),a=40*randomInt(-e,e),!bot.target||!isTargetValid(bot.target)){if(console.log("no target!"),!updateTarget())return console.log("Failed to update target, calling random move!"),void randomMove();console.log("Updated target: ",bot.target.id)}var s=getPos(bot.target);if(console.log("Current target: ",bot.target),"glow"==bot.target.type)bot.blacklistObjectBuffer=bot.target.id,moveShip(s.x,s.y),setTimeout(blacklist,6e4);else if("animal"==bot.target.type)if(isInRange(bot.target,200)){if(bot.playerAttacking)return;ArmadaBattle.Game.myPlayer.startShoot(!1,"harpoon",bot.target,{})}else{if(isPlayerMoving())return;moveShip(s.x+t,s.y+a)}else if("npc"==bot.target.type)if(isInRange(bot.target,300)){if(bot.playerAttacking)return;ArmadaBattle.Game.myPlayer.startShoot(!1,"cannonball",bot.target,{})}else if(isPlayerMoving()){if(ArmadaBattle.CustomHelper.getDistanceBetweenTwoPoints(o,s)<bot.previousDistance)return void console.log("Getting closer!");console.log("gap closing!"),moveShip(s.x+t,s.y+a)}else moveShip(s.x+t,s.y+a);bot.previousDistance=ArmadaBattle.CustomHelper.getDistanceBetweenTwoPoints(o,s)}}function startBot(){bs.ai&&(ArmadaBattle.Player.checkTowerDistances=function(){}),interval=setInterval("cycle()",2500)}function stopBot(){clearInterval(interval)}ArmadaBattle.Game.myPlayer.cancelShoot=function(e){window.bot.playerAttacking=!1,_cancelShoot.call(ArmadaBattle.Game.myPlayer,e)},setup_proxy(),startBot();